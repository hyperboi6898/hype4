<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6CP5DVM08Z"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6CP5DVM08Z');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ªëng k√™ Hyperliquid - Ph√≠ giao d·ªãch v√† gi√° token</title>
    <meta name="description" content="Theo d√µi ph√≠ giao d·ªãch h√†ng ng√†y v√† gi√° token c·ªßa Hyperliquid - C·∫≠p nh·∫≠t theo th·ªùi gian th·ª±c">
    <meta property="og:title" content="Th·ªëng k√™ Hyperliquid - Ph√≠ giao d·ªãch v√† gi√° token">
    <meta property="og:description" content="Theo d√µi ph√≠ giao d·ªãch h√†ng ng√†y v√† gi√° token c·ªßa Hyperliquid - C·∫≠p nh·∫≠t theo th·ªùi gian th·ª±c">
    <meta property="og:image" content="blog/images/image.webp">
    <meta property="og:url" content="https://hyperliquid-vietnam.com/stats.html">
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="Hyperliquid, HYPE, crypto stats, trading volume, TVL, perpetual exchange, DeFi stats, crypto metrics, decentralized exchange">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Th·ªëng k√™ Hyperliquid - Ph√≠ giao d·ªãch v√† gi√° token">
    <meta name="twitter:description" content="Theo d√µi ph√≠ giao d·ªãch h√†ng ng√†y v√† gi√° token c·ªßa Hyperliquid - C·∫≠p nh·∫≠t theo th·ªùi gian th·ª±c">
    <meta name="twitter:image" content="blog/images/image.webp">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://hyperliquid-vietnam.com/stats.html">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/styles-part2.css">
    <link rel="stylesheet" href="css/styles-part3.css">
    <link rel="stylesheet" href="css/styles-part4.css">
    <link rel="stylesheet" href="css/styles-part5.css">
    <link rel="stylesheet" href="css/styles-part6.css">
    <link rel="stylesheet" href="css/stats.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body data-theme="dark">
    <!-- Price Ticker -->
    <div class="price-ticker">
        <div class="ticker-content">
            <div class="price-item">
                <span>üíé HYPE:</span>
                <span id="hype-price">$36.92</span>
                <span id="hype-change" class="price-change positive">+2.23%</span>
            </div>
            <div class="price-item">
                <span>üìä 24h Volume:</span>
                <span>$438.7M</span>
            </div>
            <div class="price-item">
                <span>üî• TVL:</span>
                <span>$12.8B</span>
            </div>
            <div class="price-item">
                <span>‚ö° TPS:</span>
                <span>200,000</span>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <nav class="container">
            <div class="logo">
                Hyperliquid Vietnam
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Trang ch·ªß</a></li>
                <li><a href="index.html#features">T√≠nh nƒÉng</a></li>
                <li><a href="index.html#faq">FAQ</a></li>
                <li><a href="stats.html" class="active">Th·ªëng k√™</a></li>
                <li><a href="blog/index.html">Blog</a></li>
                <li><a href="https://app.hyperliquid.xyz/join/VN84" target="_blank" rel="noopener" style="color:#00eaff;font-weight:bold;">B·∫Øt ƒë·∫ßu giao d·ªãch</a></li>
            </ul>
            <div class="nav-controls">
                <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
                <button class="lang-toggle" onclick="toggleLanguage()">üáªüá≥</button>
                <div class="menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Stats Hero Section -->
    <section class="stats-hero">
        <div class="container">
            <div class="section-title fade-in">
                <h1>Th·ªëng k√™ Hyperliquid</h1>
                <p>Theo d√µi ph√≠ giao d·ªãch v√† gi√° token theo th·ªùi gian th·ª±c</p>
            </div>
        </div>
    </section>

    <!-- Stats Dashboard -->
    <section class="stats-dashboard">
        <div class="container">
            <!-- Price Chart Section -->
            <div class="price-section-title fade-in">
                <h2>Bi·ªÉu ƒë·ªì gi√° HYPE</h2>
            </div>
            
            <!-- DexScreener Embed (Full Width) -->
            <div class="dexscreener-container fade-in">
                <style>
                    .dexscreener-container {
                        margin-top: 2rem;
                        margin-bottom: 3rem;
                        background: var(--background-card);
                        border-radius: 16px;
                        border: 1px solid var(--border-color);
                        overflow: hidden;
                        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
                    }
                    #dexscreener-embed {
                        position: relative;
                        width: 100%;
                        padding-bottom: 80%;
                    }
                    @media(min-width:1400px) {
                        #dexscreener-embed {
                            padding-bottom: 50%;
                        }
                    }
                    #dexscreener-embed iframe {
                        position: absolute;
                        width: 100%;
                        height: 100%;
                        top: 0;
                        left: 0;
                        border: 0;
                    }
                </style>
                <div id="dexscreener-embed">
                    <iframe src="https://dexscreener.com/hyperliquid/0x13ba5fea7078ab3798fbce53b4d0721c?embed=1&loadChartSettings=0&chartLeftToolbar=0&chartTheme=dark&theme=dark&chartStyle=0&chartType=usd&interval=15"></iframe>
                </div>
            </div>

            <!-- Stats Overview -->
            <div class="stats-overview fade-in">
                <div class="stats-overview-grid">
                    <!-- Fee Stats Card -->
                    <div class="stats-card">
                        <div class="stats-card-header">
                            <h2>Ph√≠ giao d·ªãch h√†ng ng√†y</h2>
                            <div class="stats-card-actions">
                                <button class="btn-refresh" onclick="fetchFeeData()">üîÑ</button>
                                <button class="btn-timeframe active" data-timeframe="7d">7 ng√†y</button>
                                <button class="btn-timeframe" data-timeframe="30d">30 ng√†y</button>
                                <button class="btn-timeframe" data-timeframe="90d">90 ng√†y</button>
                            </div>
                        </div>
                        <div class="stats-card-body">
                            <div class="stats-highlight">
                                <div class="stats-value">
                                    <span id="today-fee">$3,017,044</span>
                                    <div class="stats-change" id="fee-change">
                                        <span class="change-value negative">-3.73%</span>
                                        <span class="change-label">so v·ªõi h√¥m qua</span>
                                    </div>
                                </div>
                                <div class="stats-label">Ph√≠ giao d·ªãch h√¥m nay</div>
                            </div>
                            <div class="stats-chart-container">
                                <canvas id="fee-chart"></canvas>
                            </div>
                        </div>
                        <div class="stats-card-footer">
                            <div class="stats-summary">
                                <div class="stats-summary-item">
                                    <span class="summary-label">7 ng√†y</span>
                                    <span class="summary-value" id="fee-7d">$18,062,999</span>
                                </div>
                                <div class="stats-summary-item">
                                    <span class="summary-label">T·ªïng ph√≠</span>
                                    <span class="summary-value" id="fee-total">$383,922,252</span>
                                </div>
                            </div>
                            <div class="stats-source">Ngu·ªìn: DeFi Llama API</div>
                        </div>
                    </div>

                    <!-- TVL Stats Card -->
                    <div class="stats-card">
                        <div class="stats-card-header">
                            <h2>T·ªïng gi√° tr·ªã kh√≥a (TVL)</h2>
                            <div class="stats-card-actions">
                                <button class="btn-refresh" onclick="fetchTVLData()">üîÑ</button>
                            </div>
                        </div>
                        <div class="stats-card-body">
                            <div class="stats-highlight">
                                <div class="stats-value">
                                    <span id="current-tvl">$1,758,094,425</span>
                                    <div class="stats-change" id="tvl-change">
                                        <span class="change-value positive">+2.15%</span>
                                        <span class="change-label">7 ng√†y qua</span>
                                    </div>
                                </div>
                                <div class="stats-label">TVL hi·ªán t·∫°i</div>
                            </div>
                            <div class="tvl-breakdown">
                                <h3>Stablecoins tr√™n Hyperliquid L1</h3>
                                <div class="stablecoin-list">
                                    <div class="stablecoin-item">
                                        <div class="stablecoin-name">USDC</div>
                                        <div class="stablecoin-value">$1,775,483,252</div>
                                    </div>
                                    <div class="stablecoin-item">
                                        <div class="stablecoin-name">USDT</div>
                                        <div class="stablecoin-value">$13,728,464</div>
                                    </div>
                                    <div class="stablecoin-item">
                                        <div class="stablecoin-name">FEUSD</div>
                                        <div class="stablecoin-value">$26,850,734</div>
                                    </div>
                                    <div class="stablecoin-item">
                                        <div class="stablecoin-name">USDe</div>
                                        <div class="stablecoin-value">$7,282,764</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="stats-card-footer">
                            <div class="stats-source">Ngu·ªìn: DeFi Llama API</div>
                        </div>
                    </div>
                </div>

                <!-- Volume Stats Card (Full Width) -->
                <div class="stats-card volume-card">
                    <div class="stats-card-header">
                        <h2>Kh·ªëi l∆∞·ª£ng giao d·ªãch Perp</h2>
                        <div class="stats-card-actions">
                            <button class="btn-refresh" onclick="fetchVolumeData()">üîÑ</button>
                        </div>
                    </div>
                    <div class="stats-card-body">
                        <div class="stats-highlight">
                            <div class="stats-value">
                                <span id="current-volume">$11,086,221,730</span>
                                <div class="stats-change" id="volume-change">
                                    <span class="change-value positive">+2.72%</span>
                                    <span class="change-label">so v·ªõi h√¥m qua</span>
                                </div>
                            </div>
                            <div class="stats-label">Kh·ªëi l∆∞·ª£ng giao d·ªãch h√¥m nay</div>
                        </div>
                    </div>
                    <div class="stats-card-footer">
                        <div class="stats-summary">
                            <div class="stats-summary-item">
                                <span class="summary-label">7 ng√†y</span>
                                <span class="summary-value" id="weekly-volume">$65,560,958,107</span>
                            </div>
                            <div class="stats-summary-item">
                                <span class="summary-label">T·ªïng kh·ªëi l∆∞·ª£ng</span>
                                <span class="summary-value" id="total-volume">$1,610,642,751,323</span>
                            </div>
                            <div class="stats-summary-item">
                                <span class="summary-label">Th·ªã ph·∫ßn</span>
                                <span class="summary-value" id="market-share">15.8%</span>
                            </div>
                        </div>
                        <div class="stats-source">Ngu·ªìn: DeFi Llama API</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Volume and Open Interest Comparison Charts Section -->
    <section class="comparison-charts-section">
        <div class="container">
            <div class="section-title fade-in">
                <h2>So s√°nh v·ªõi c√°c s√†n kh√°c</h2>
            </div>
            <div class="stats-overview fade-in">
                <!-- Volume Comparison Chart -->
                <div class="stats-card volume-comparison-card">
                    <div class="stats-card-header">
                        <h2>So s√°nh kh·ªëi l∆∞·ª£ng giao d·ªãch</h2>
                    </div>
                    <div class="stats-card-body">
                        <div class="stats-chart-container">
                            <canvas id="volumeComparisonChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Open Interest Comparison Chart -->
                <div class="stats-card open-interest-comparison-card">
                    <div class="stats-card-header">
                        <h2>So s√°nh Open Interest</h2>
                    </div>
                    <div class="stats-card-body">
                        <div class="stats-chart-container">
                            <canvas id="openInterestComparisonChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Keyword Rich Content Section -->
    <section class="content-section">
        <div class="container">
            <div class="content-wrapper fade-in">
                <h2>Th·ªëng k√™ Hyperliquid - Theo d√µi d·ªØ li·ªáu th·ªã tr∆∞·ªùng theo th·ªùi gian th·ª±c</h2>
                <div class="content-grid">
                    <div class="content-item">
                        <h3>Bi·ªÉu ƒë·ªì gi√° Hyperliquid</h3>
                        <p>Theo d√µi bi·ªÉu ƒë·ªì gi√° HYPE theo th·ªùi gian th·ª±c v·ªõi c√°c c√¥ng c·ª• ph√¢n t√≠ch k·ªπ thu·∫≠t. Bi·ªÉu ƒë·ªì Hyperliquid c·∫≠p nh·∫≠t li√™n t·ª•c gi√∫p b·∫°n n·∫Øm b·∫Øt m·ªçi bi·∫øn ƒë·ªông c·ªßa th·ªã tr∆∞·ªùng.</p>
                    </div>
                    <div class="content-item">
                        <h3>TVL Hyperliquid</h3>
                        <p>T·ªïng gi√° tr·ªã kh√≥a (TVL) tr√™n Hyperliquid L1 ƒë·∫°t h∆°n $1.7 t·ª∑ v·ªõi c√°c stablecoin ch√≠nh bao g·ªìm USDC, USDT, FEUSD v√† USDe. Theo d√µi TVL Hyperliquid ƒë·ªÉ ƒë√°nh gi√° s·ª± tƒÉng tr∆∞·ªüng c·ªßa h·ªá sinh th√°i.</p>
                    </div>
                    <div class="content-item">
                        <h3>Ph√≠ giao d·ªãch v√† Buy Back</h3>
                        <p>97% ph√≠ giao d·ªãch tr√™n Hyperliquid ƒë∆∞·ª£c d√πng ƒë·ªÉ buy back token HYPE, t·∫°o √°p l·ª±c mua li√™n t·ª•c tr√™n th·ªã tr∆∞·ªùng. Theo d√µi doanh thu ph√≠ giao d·ªãch h√†ng ng√†y ƒë·ªÉ d·ª± ƒëo√°n t√°c ƒë·ªông ƒë·∫øn gi√° token.</p>
                    </div>
                    <div class="content-item">
                        <h3>Kh·ªëi l∆∞·ª£ng giao d·ªãch Hyperliquid</h3>
                        <p>S√†n Hyperliquid ƒë·∫°t kh·ªëi l∆∞·ª£ng giao d·ªãch h∆°n $11 t·ª∑ m·ªói ng√†y, v∆∞∆°n l√™n v·ªã tr√≠ h√†ng ƒë·∫ßu trong c√°c s√†n giao d·ªãch phi t·∫≠p trung. Th·ªëng k√™ volume giao d·ªãch c·ªßa Hyperliquid cho th·∫•y s·ª± tƒÉng tr∆∞·ªüng ·ªïn ƒë·ªãnh.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-content fade-in">
                <h2>B·∫Øt ƒë·∫ßu giao d·ªãch tr√™n Hyperliquid ngay h√¥m nay</h2>
                <p>Tr·∫£i nghi·ªám giao d·ªãch Perp v·ªõi ph√≠ th·∫•p, t·ªëc ƒë·ªô nhanh v√† thanh kho·∫£n cao nh·∫•t th·ªã tr∆∞·ªùng</p>
                <div class="cta-buttons">
                    <a href="https://app.hyperliquid.xyz/join/VN84" class="btn-primary">ƒêƒÉng k√Ω t√†i kho·∫£n</a>
                    <a href="https://docs.hyperliquid.xyz/" class="btn-secondary">T√¨m hi·ªÉu th√™m</a>
                </div>
                <div class="cta-features">
                    <div class="feature-item">
                        <div class="feature-icon">üí∞</div>
                        <div class="feature-text">
                            <h3>Ph√≠ giao d·ªãch th·∫•p</h3>
                            <p>Ch·ªâ 0.05% cho maker v√† 0.07% cho taker, 97% ph√≠ ƒë∆∞·ª£c d√πng ƒë·ªÉ buy back token</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">‚ö°</div>
                        <div class="feature-text">
                            <h3>T·ªëc ƒë·ªô nhanh</h3>
                            <p>X√°c nh·∫≠n giao d·ªãch trong v√≤ng 500ms tr√™n Hyperliquid L1</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üìä</div>
                        <div class="feature-text">
                            <h3>Thanh kho·∫£n cao</h3>
                            <p>H∆°n $11B kh·ªëi l∆∞·ª£ng giao d·ªãch h√†ng ng√†y tr√™n s√†n Hyperliquid</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>Hyperliquid Vietnam</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        C·ªông ƒë·ªìng Hyperliquid Vietnam - N∆°i k·∫øt n·ªëi c√°c trader DeFi h√†ng ƒë·∫ßu.
                    </p>
                    <div class="social-links">
                        <a href="#" class="social-link" title="X (Twitter)">ùïè</a>
                        <a href="#" class="social-link" title="YouTube">üì∫</a>
                        <a href="#" class="social-link" title="Facebook">üìò</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>S·∫£n ph·∫©m</h4>
                    <ul>
                        <li><a href="https://app.hyperliquid.xyz/join/VN84" target="_blank">Perpetual Futures</a></li>
                        <li><a href="https://app.hyperliquid.xyz/join/VN84" target="_blank">Spot Trading</a></li>
                        <li><a href="https://app.hyperliquid.xyz/join/VN84" target="_blank">Staking</a></li>
                        <li><a href="https://app.hyperliquid.xyz/join/VN84" target="_blank">Vault</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>C·ªông ƒë·ªìng</h4>
                    <ul>
                        <li><a href="#">Telegram Vi·ªát Nam</a></li>
                        <li><a href="#">Discord Global</a></li>
                        <li><a href="#">X (Twitter)</a></li>
                        <li><a href="#">YouTube Channel</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>T√†i nguy√™n</h4>
                    <ul>
                        <li><a href="https://hyperliquid.gitbook.io/hyperliquid-docs" target="_blank">Documentation</a></li>
                        <li><a href="https://docs.hyperliquid.xyz/developer" target="_blank">API Docs</a></li>
                        <li><a href="blog/index.html">Blog & Tutorials</a></li>
                        <li><a href="index.html#faq">H·ªó tr·ª£</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Hyperliquid Vietnam Community. Kh√¥ng ph·∫£i website ch√≠nh th·ª©c c·ªßa Hyperliquid Labs.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        // Fetch fee, TVL, and volume data from JSON files
        async function fetchFeeData() {
            try {
                // Show loading state
                document.getElementById('today-fee').innerHTML = '$<span class="loading"></span>';
                document.getElementById('fee-7d').innerHTML = '$<span class="loading"></span>';
                
                const response = await fetch('data/fee_data.json');
                if (!response.ok) {
                    throw new Error('Failed to fetch fee data');
                }
                
                const data = await response.json();
                
                // Update UI with the latest data
                updateFeeUI(data);
                
                // Initialize or update fee chart
                initFeeChart(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching fee data:', error);
                
                // Show error state
                document.getElementById('today-fee').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('fee-7d').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                
                return null;
            }
        }
        
        function updateFeeUI(data) {
            if (!data) return;
            
            // Get the latest fee data from totalDataChart
            let todayFee = data.total24h || 0;
            let yesterdayFee = data.total48hto24h || 0;
            
            // Check if totalDataChart exists and has data
            if (data.totalDataChart && Array.isArray(data.totalDataChart) && data.totalDataChart.length > 1) {
                // Get the latest entry from totalDataChart
                const latestEntry = data.totalDataChart[data.totalDataChart.length - 1];
                if (latestEntry && Array.isArray(latestEntry) && latestEntry.length > 1) {
                    // Use this value as today's fee
                    todayFee = latestEntry[1];
                    
                    // Get yesterday's fee from the second-to-last entry
                    const yesterdayEntry = data.totalDataChart[data.totalDataChart.length - 2];
                    if (yesterdayEntry && Array.isArray(yesterdayEntry) && yesterdayEntry.length > 1) {
                        yesterdayFee = yesterdayEntry[1];
                    }
                }
            }
            
            const weeklyFee = data.total7d || 0;
            const totalFee = data.totalAllTime || 0;
            
            // Calculate change percentage
            const changePercent = yesterdayFee > 0 ? ((todayFee - yesterdayFee) / yesterdayFee * 100).toFixed(2) : '0.00';
            const changeClass = parseFloat(changePercent) >= 0 ? 'positive' : 'negative';
            const changeSign = parseFloat(changePercent) >= 0 ? '+' : '';
            
            // Update UI elements
            document.getElementById('today-fee').textContent = '$' + formatLargeNumber(todayFee);
            document.getElementById('fee-7d').textContent = '$' + formatLargeNumber(weeklyFee);
            document.getElementById('fee-total').textContent = '$' + formatLargeNumber(totalFee);
            
            document.getElementById('fee-change').innerHTML = `
                <span class="change-value ${changeClass}">${changeSign}${changePercent}%</span>
                <span class="change-label">so v·ªõi h√¥m qua</span>
            `;
            
            // Log for debugging
            console.log('Fee data:', {
                todayFee,
                yesterdayFee,
                weeklyFee,
                totalFee,
                changePercent
            });
        }
        
        function initFeeChart(data) {
            if (!data || !data.totalDataChart || !data.totalDataChart.length) {
                console.error('Invalid fee data structure for chart');
                return;
            }
            
            try {
                // Process the data into the format we need
                const processedData = processChartData(data.totalDataChart);
                
                // Set up the chart
                const ctx = document.getElementById('fee-chart').getContext('2d');
                
                // Check if chart already exists and destroy it
                if (window.feeChart) {
                    window.feeChart.destroy();
                }
                
                // Create gradient for the chart
                const gradient = ctx.createLinearGradient(0, 0, 0, 300);
                gradient.addColorStop(0, 'rgba(0, 234, 255, 0.5)');
                gradient.addColorStop(1, 'rgba(0, 234, 255, 0)');
                
                // Default to 7 days of data
                const chartData = getTimeframeData(processedData, '7d');
                
                window.feeChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: chartData.dates,
                        datasets: [{
                            label: 'Ph√≠ giao d·ªãch',
                            data: chartData.values,
                            borderColor: '#00eaff',
                            backgroundColor: gradient,
                            borderWidth: 2,
                            pointRadius: 3,
                            pointBackgroundColor: '#00eaff',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    label: function(context) {
                                        return '$' + formatLargeNumber(context.raw);
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return '$' + formatLargeNumber(value);
                                    }
                                }
                            }
                        }
                    }
                });
                
                // Store the processed data for later use
                window.feeChartData = processedData;
                
                // Add event listeners to timeframe buttons
                document.querySelectorAll('.btn-timeframe').forEach(button => {
                    button.addEventListener('click', function() {
                        // Remove active class from all buttons
                        document.querySelectorAll('.btn-timeframe').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        
                        // Add active class to clicked button
                        this.classList.add('active');
                        
                        // Update chart based on selected timeframe
                        updateFeeChart(this.dataset.timeframe);
                    });
                });
                
                // Set 7d as active by default
                document.querySelector('.btn-timeframe[data-timeframe="7d"]').classList.add('active');
            } catch (error) {
                console.error('Error initializing fee chart:', error);
            }
        }
        
        // Process the raw chart data from the API into a more usable format
        function processChartData(chartData) {
            try {
                if (!Array.isArray(chartData)) {
                    console.error('Chart data is not an array');
                    return [];
                }
                
                // Sort by timestamp (first element in each array)
                const sortedData = [...chartData].sort((a, b) => a[0] - b[0]);
                
                // Convert to our format
                return sortedData.map(item => {
                    // Convert timestamp to date string
                    const date = new Date(item[0] * 1000);
                    const dateStr = date.toISOString().split('T')[0];
                    
                    return {
                        date: dateStr,
                        value: item[1] || 0
                    };
                });
            } catch (error) {
                console.error('Error processing chart data:', error);
                return [];
            }
        }
        
        // Get data for a specific timeframe
        function getTimeframeData(data, timeframe) {
            if (!Array.isArray(data) || data.length === 0) {
                return { dates: [], values: [] };
            }
            
            let filteredData;
            
            switch(timeframe) {
                case '7d':
                    // Last 7 days
                    filteredData = data.slice(-7);
                    break;
                case '30d':
                    // Last 30 days
                    filteredData = data.slice(-30);
                    break;
                case '90d':
                    // Last 90 days
                    filteredData = data.slice(-90);
                    break;
                default:
                    // Default to 7 days
                    filteredData = data.slice(-7);
            }
            
            return {
                dates: filteredData.map(item => item.date),
                values: filteredData.map(item => item.value)
            };
        }
        
        function updateFeeChart(timeframe) {
            if (!window.feeChartData || !window.feeChart) {
                console.error('Fee chart or data not initialized');
                return;
            }
            
            try {
                const chartData = getTimeframeData(window.feeChartData, timeframe);
                
                // Update the chart with new data
                window.feeChart.data.labels = chartData.dates;
                window.feeChart.data.datasets[0].data = chartData.values;
                window.feeChart.update();
            } catch (error) {
                console.error('Error updating fee chart:', error);
            }
        }
        
        // Functions for TVL data
        async function fetchTVLData() {
            try {
                // Show loading state
                document.getElementById('current-tvl').innerHTML = '$<span class="loading"></span>';
                
                const response = await fetch('data/tvl_data.json');
                if (!response.ok) {
                    throw new Error('Failed to fetch TVL data');
                }
                
                const data = await response.json();
                
                // Update UI with the latest data
                updateTVLUI(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching TVL data:', error);
                
                // Show error state
                document.getElementById('current-tvl').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                
                return null;
            }
        }
        
        function updateTVLUI(data) {
            if (!data || !Array.isArray(data) || data.length === 0) {
                console.error('Invalid TVL data structure');
                return;
            }
            
            try {
                // Get the latest day's TVL
                const latestDay = data[data.length - 1];
                
                // Get the TVL from 7 days ago for comparison
                const sevenDaysAgo = data.length > 7 ? data[data.length - 8] : data[0];
                
                // Calculate change percentage over 7 days
                const latestTVL = latestDay.totalLiquidityUSD || 0;
                const sevenDaysAgoTVL = sevenDaysAgo.totalLiquidityUSD || 0;
                
                const changePercent = sevenDaysAgoTVL > 0 ? 
                    ((latestTVL - sevenDaysAgoTVL) / sevenDaysAgoTVL * 100).toFixed(2) : '0.00';
                const changeClass = parseFloat(changePercent) >= 0 ? 'positive' : 'negative';
                const changeSign = parseFloat(changePercent) >= 0 ? '+' : '';
                
                // Update UI elements
                document.getElementById('current-tvl').textContent = '$' + formatLargeNumber(latestTVL);
                
                document.getElementById('tvl-change').innerHTML = `
                    <span class="change-value ${changeClass}">${changeSign}${changePercent}%</span>
                    <span class="change-label">7 ng√†y qua</span>
                `;
            } catch (error) {
                console.error('Error updating TVL UI:', error);
                document.getElementById('current-tvl').textContent = 'L·ªói d·ªØ li·ªáu';
            }
        }
        
        // Functions for Volume data
        async function fetchVolumeData() {
            try {
                // Show loading state
                document.getElementById('daily-volume').innerHTML = '$<span class="loading"></span>';
                document.getElementById('weekly-volume').innerHTML = '$<span class="loading"></span>';
                document.getElementById('total-volume').innerHTML = '$<span class="loading"></span>';
                
                // Ch·ªâ s·ª≠ d·ª•ng volume_data.json
                const response = await fetch('data/volume_data.json');
                if (!response.ok) {
                    throw new Error('Failed to fetch volume_data.json');
                }
                
                const data = await response.json();
                console.log('Successfully loaded volume_data.json');
                
                // Update UI with the latest data
                updateVolumeUI(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching volume data:', error);
                
                // Show error state
                document.getElementById('daily-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('weekly-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('total-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                
                return null;
            }
        }
        
        // Kh√¥ng c√≤n s·ª≠ d·ª•ng h√†m updateVolumeUIFallback
        
        // For volume_data.json format
        function updateVolumeUI(data) {
            if (!data || typeof data !== 'object' || Object.keys(data).length === 0) {
                console.error('Invalid volume data format');
                return;
            }
            
            try {
                console.log('Processing volume data:', Object.keys(data).length, 'dates');
                
                // Get dates in order to find latest data
                const dates = Object.keys(data).sort();
                if (dates.length === 0) {
                    throw new Error('No dates found in volume data');
                }
                
                // Lu√¥n l·∫•y ng√†y m·ªõi nh·∫•t
                const latestDate = dates[dates.length - 1]; // Latest date
                console.log('Latest date:', latestDate);
                
                // Ki·ªÉm tra d·ªØ li·ªáu HYPERLIQUID c√≥ t·ªìn t·∫°i kh√¥ng
                if (!data[latestDate] || !data[latestDate].HYPERLIQUID) {
                    console.error('No HYPERLIQUID data for latest date:', latestDate);
                    console.log('Available keys:', Object.keys(data[latestDate] || {}));
                    throw new Error('Missing HYPERLIQUID data for latest date');
                }
                
                // L·∫•y ng√†y h√¥m tr∆∞·ªõc ƒë·ªÉ so s√°nh
                const yesterdayDate = dates.length > 1 ? dates[dates.length - 2] : latestDate;
                
                // L·∫•y d·ªØ li·ªáu 7 ng√†y g·∫ßn nh·∫•t n·∫øu c√≥
                const weeklyDates = dates.slice(-7);
                
                // L·∫•y gi√° tr·ªã kh·ªëi l∆∞·ª£ng giao d·ªãch c·ªßa HYPERLIQUID
                const dailyVolume = data[latestDate].HYPERLIQUID || 0;
                const previousDayVolume = data[yesterdayDate].HYPERLIQUID || 0;
                
                // In ra th√¥ng tin debug
                console.log('Latest HYPERLIQUID volume:', dailyVolume);
                console.log('Previous day HYPERLIQUID volume:', previousDayVolume);
                
                // T√≠nh t·ªïng kh·ªëi l∆∞·ª£ng giao d·ªãch 7 ng√†y
                let weeklyVolume = 0;
                weeklyDates.forEach(date => {
                    if (data[date] && data[date].HYPERLIQUID) {
                        weeklyVolume += data[date].HYPERLIQUID;
                    }
                });
                
                // T√≠nh t·ªïng kh·ªëi l∆∞·ª£ng giao d·ªãch m·ªçi th·ªùi ƒëi·ªÉm
                let totalVolume = 0;
                dates.forEach(date => {
                    if (data[date] && data[date].HYPERLIQUID) {
                        totalVolume += data[date].HYPERLIQUID;
                    }
                });
                
                // T√≠nh th·ªã ph·∫ßn so v·ªõi Binance
                const binanceVolume = data[latestDate].BINANCE || 0;
                const marketShare = binanceVolume > 0 ? dailyVolume / binanceVolume : 0;
                
                // T√≠nh ph·∫ßn trƒÉm thay ƒë·ªïi
                const changePercent = previousDayVolume > 0 ? 
                    ((dailyVolume - previousDayVolume) / previousDayVolume * 100).toFixed(2) : '0.00';
                const changeClass = parseFloat(changePercent) >= 0 ? 'positive' : 'negative';
                const changeSign = parseFloat(changePercent) >= 0 ? '+' : '';
                
                // C·∫≠p nh·∫≠t giao di·ªán ng∆∞·ªùi d√πng
                document.getElementById('daily-volume').textContent = '$' + formatLargeNumber(dailyVolume);
                document.getElementById('weekly-volume').textContent = '$' + formatLargeNumber(weeklyVolume);
                document.getElementById('total-volume').textContent = '$' + formatLargeNumber(totalVolume);
                
                document.getElementById('volume-change').innerHTML = `
                    <span class="change-value ${changeClass}">${changeSign}${changePercent}%</span>
                    <span class="change-label">so v·ªõi h√¥m qua</span>
                `;
                
                // C·∫≠p nh·∫≠t th·ªã ph·∫ßn
                document.getElementById('market-share').textContent = (marketShare * 100).toFixed(2) + '%';
                
                console.log('Volume UI updated successfully with:', {
                    dailyVolume,
                    weeklyVolume,
                    totalVolume,
                    changePercent,
                    marketShare: (marketShare * 100).toFixed(2) + '%'
                });
            } catch (error) {
                console.error('Error updating volume UI:', error);
                // Hi·ªÉn th·ªã th√¥ng b√°o l·ªói
                document.getElementById('daily-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('weekly-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('total-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
            }
        }
        
        // Kh√¥ng c√≤n s·ª≠ d·ª•ng h√†m fetchFallbackVolumeData
        
        // Initialize all data on page load
        async function initAllData() {
            try {
                // Fetch all data types in parallel
                const [feeData, tvlData, volumeData] = await Promise.allSettled([
                    fetchFeeData(),
                    fetchTVLData(),
                    fetchVolumeData()
                ]);
                
                console.log('All data initialized:', {
                    feeStatus: feeData.status,
                    tvlStatus: tvlData.status,
                    volumeStatus: volumeData.status
                });
            } catch (error) {
                console.error('Error initializing data:', error);
            }
        }
        
        // Initialize all data when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            initAllData();
            
            // Also initialize comparison charts
            fetchAndRenderComparisonCharts();
        });
        
        // Get data for a specific timeframe
        function getTimeframeData(data, timeframe) {
            if (!Array.isArray(data) || data.length === 0) {
                return { dates: [], values: [] };
            }
            
            let filteredData;
            const now = new Date();
            
            switch(timeframe) {
                case '7d':
                    // Last 7 days
                    filteredData = data.slice(-7);
                    break;
                case '30d':
                    // Last 30 days
                    filteredData = data.slice(-30);
                    break;
                case '90d':
                    // Last 90 days
                    filteredData = data.slice(-90);
                    break;
                default:
                    // Default to 7 days
                    filteredData = data.slice(-7);
            }
            
            return {
                dates: filteredData.map(item => item.date),
                values: filteredData.map(item => item.value)
            };
        }
        
        function updateFeeChart(timeframe) {
            if (!window.feeChartData || !window.feeChart) {
                console.error('Fee chart or data not initialized');
                return;
            }
            
            try {
                const chartData = getTimeframeData(window.feeChartData, timeframe);
                
                // Update the chart with new data
                window.feeChart.data.labels = chartData.dates;
                window.feeChart.data.datasets[0].data = chartData.values;
                window.feeChart.update();
            } catch (error) {
                console.error('Error updating fee chart:', error);
            }
        }
        
        function getLast7DaysData(data) {
            const last7Days = data.slice(-7);
            return {
                dates: last7Days.map(day => formatDate(day.date)),
                values: last7Days.map(day => day.dailyFees)
            };
        }
        
        function getLast30DaysData(data) {
            const last30Days = data.slice(-30);
            return {
                dates: last30Days.map(day => formatDate(day.date)),
                values: last30Days.map(day => day.dailyFees)
            };
        }
        
        function getLast90DaysData(data) {
            const last90Days = data.slice(-90);
            return {
                dates: last90Days.map(day => formatDate(day.date)),
                values: last90Days.map(day => day.dailyFees)
            };
        }
        
        async function fetchTVLData() {
            try {
                // Show loading state
                document.getElementById('current-tvl').innerHTML = '$<span class="loading"></span>';
                
                const response = await fetch('data/tvl_data.json');
                if (!response.ok) {
                    throw new Error('Failed to fetch TVL data');
                }
                
                const data = await response.json();
                
                // Update UI with the latest data
                updateTVLUI(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching TVL data:', error);
                
                // Show error state
                document.getElementById('current-tvl').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                
                return null;
            }
        }
        
        function updateTVLUI(data) {
            if (!data || !Array.isArray(data) || data.length === 0) {
                console.error('Invalid TVL data structure');
                return;
            }
            
            try {
                // Get the latest day's TVL
                const latestDay = data[data.length - 1];
                
                // Get the TVL from 7 days ago for comparison
                const sevenDaysAgo = data.length > 7 ? data[data.length - 8] : data[0];
                
                // Calculate change percentage over 7 days
                const latestTVL = latestDay.totalLiquidityUSD || 0;
                const sevenDaysAgoTVL = sevenDaysAgo.totalLiquidityUSD || 0;
                
                const changePercent = sevenDaysAgoTVL > 0 ? 
                    ((latestTVL - sevenDaysAgoTVL) / sevenDaysAgoTVL * 100).toFixed(2) : '0.00';
                const changeClass = parseFloat(changePercent) >= 0 ? 'positive' : 'negative';
                const changeSign = parseFloat(changePercent) >= 0 ? '+' : '';
                
                // Update UI elements
                document.getElementById('current-tvl').textContent = '$' + formatLargeNumber(latestTVL);
                
                document.getElementById('tvl-change').innerHTML = `
                    <span class="change-value ${changeClass}">${changeSign}${changePercent}%</span>
                    <span class="change-label">7 ng√†y qua</span>
                `;
            } catch (error) {
                console.error('Error updating TVL UI:', error);
                document.getElementById('current-tvl').textContent = 'L·ªói d·ªØ li·ªáu';
            }
        }
        
        async function fetchVolumeData() {
            try {
                // Show loading state
                document.getElementById('current-volume').innerHTML = '$<span class="loading"></span>';
                document.getElementById('weekly-volume').innerHTML = '$<span class="loading"></span>';
                
                const response = await fetch('data/volume_data.json');
                if (!response.ok) {
                    throw new Error('Failed to fetch volume data');
                }
                
                const data = await response.json();
                console.log('Successfully loaded volume_data.json');
                
                // Update UI with the latest data
                updateVolumeUI(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching volume data:', error);
                
                // Show error state
                document.getElementById('current-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('weekly-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                
                return null;
            }
        }
        
        function updateVolumeUI(data) {
            if (!data || typeof data !== 'object' || Object.keys(data).length === 0) {
                console.error('Invalid volume data format');
                return;
            }
            
            try {
                console.log('Processing volume data:', Object.keys(data).length, 'dates');
                
                // Get dates in order to find latest data
                const dates = Object.keys(data).sort();
                if (dates.length === 0) {
                    throw new Error('No dates found in volume data');
                }
                
                // Lu√¥n l·∫•y ng√†y m·ªõi nh·∫•t
                const latestDate = dates[dates.length - 1]; // Latest date
                console.log('Latest date:', latestDate);
                
                // Ki·ªÉm tra d·ªØ li·ªáu HYPERLIQUID c√≥ t·ªìn t·∫°i kh√¥ng
                if (!data[latestDate] || !data[latestDate].HYPERLIQUID) {
                    console.error('No HYPERLIQUID data for latest date:', latestDate);
                    console.log('Available keys:', Object.keys(data[latestDate] || {}));
                    throw new Error('Missing HYPERLIQUID data for latest date');
                }
                
                // L·∫•y ng√†y h√¥m tr∆∞·ªõc ƒë·ªÉ so s√°nh
                const yesterdayDate = dates.length > 1 ? dates[dates.length - 2] : latestDate;
                
                // L·∫•y d·ªØ li·ªáu 7 ng√†y g·∫ßn nh·∫•t n·∫øu c√≥
                const weeklyDates = dates.slice(-7);
                
                // L·∫•y gi√° tr·ªã kh·ªëi l∆∞·ª£ng giao d·ªãch c·ªßa HYPERLIQUID
                const dailyVolume = data[latestDate].HYPERLIQUID || 0;
                const previousDayVolume = data[yesterdayDate].HYPERLIQUID || 0;
                
                // In ra th√¥ng tin debug
                console.log('Latest HYPERLIQUID volume:', dailyVolume);
                console.log('Previous day HYPERLIQUID volume:', previousDayVolume);
                
                // T√≠nh t·ªïng kh·ªëi l∆∞·ª£ng giao d·ªãch 7 ng√†y
                let weeklyVolume = 0;
                weeklyDates.forEach(date => {
                    if (data[date] && data[date].HYPERLIQUID) {
                        weeklyVolume += data[date].HYPERLIQUID;
                    }
                });
                
                // T√≠nh t·ªïng kh·ªëi l∆∞·ª£ng giao d·ªãch m·ªçi th·ªùi ƒëi·ªÉm
                let totalVolume = 0;
                dates.forEach(date => {
                    if (data[date] && data[date].HYPERLIQUID) {
                        totalVolume += data[date].HYPERLIQUID;
                    }
                });
                
                // T√≠nh th·ªã ph·∫ßn so v·ªõi Binance
                const binanceVolume = data[latestDate].BINANCE || 0;
                const marketShare = binanceVolume > 0 ? (dailyVolume / binanceVolume) * 100 : 0;
                
                // T√≠nh ph·∫ßn trƒÉm thay ƒë·ªïi
                const changePercent = previousDayVolume > 0 ? 
                    ((dailyVolume - previousDayVolume) / previousDayVolume * 100).toFixed(2) : '0.00';
                const changeClass = parseFloat(changePercent) >= 0 ? 'positive' : 'negative';
                const changeSign = parseFloat(changePercent) >= 0 ? '+' : '';
                
                // C·∫≠p nh·∫≠t giao di·ªán ng∆∞·ªùi d√πng
                document.getElementById('current-volume').textContent = '$' + formatLargeNumber(dailyVolume);
                document.getElementById('weekly-volume').textContent = '$' + formatLargeNumber(weeklyVolume);
                document.getElementById('total-volume').textContent = '$' + formatLargeNumber(totalVolume);
                
                document.getElementById('volume-change').innerHTML = `
                    <span class="change-value ${changeClass}">${changeSign}${changePercent}%</span>
                    <span class="change-label">so v·ªõi h√¥m qua</span>
                `;
                
                // C·∫≠p nh·∫≠t th·ªã ph·∫ßn
                document.getElementById('market-share').textContent = marketShare.toFixed(2) + '%';
                
                console.log('Volume UI updated successfully with:', {
                    dailyVolume,
                    weeklyVolume,
                    totalVolume,
                    changePercent,
                    marketShare: marketShare.toFixed(2) + '%'
                });
            } catch (error) {
                console.error('Error updating volume UI:', error);
                // Hi·ªÉn th·ªã th√¥ng b√°o l·ªói
                document.getElementById('current-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('weekly-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
                document.getElementById('total-volume').textContent = 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu';
            }
        }
        
        // Initialize all data on page load
        async function initAllData() {
            await Promise.all([
                fetchFeeData(),
                fetchTVLData(),
                fetchVolumeData()
            ]);
            console.log('All data loaded successfully');
        }
        
        async function fetchAndRenderComparisonCharts() {
            try {
                // Show loading state for comparison charts
                document.getElementById('volumeComparisonChart').parentNode.classList.add('loading');
                document.getElementById('openInterestComparisonChart').parentNode.classList.add('loading');
                
                // Fetch volume data with error handling
                let volumeData = null;
                try {
                    const volumeResponse = await fetch('data/volume_data.json');
                    if (!volumeResponse.ok) {
                        throw new Error(`Failed to fetch volume data: ${volumeResponse.status}`);
                    }
                    volumeData = await volumeResponse.json();
                    console.log('Volume data loaded successfully');
                } catch (volumeError) {
                    console.error('Error fetching volume data:', volumeError);
                }
                
                // Fetch open interest data with error handling
                let openInterestData = null;
                try {
                    const openInterestResponse = await fetch('data/open_interest_data.json');
                    if (!openInterestResponse.ok) {
                        throw new Error(`Failed to fetch open interest data: ${openInterestResponse.status}`);
                    }
                    openInterestData = await openInterestResponse.json();
                    console.log('Open interest data loaded successfully');
                } catch (oiError) {
                    console.error('Error fetching open interest data:', oiError);
                }
                
                // Only proceed if both data sets are available
                if (!volumeData || !openInterestData) {
                    throw new Error('One or more data sets failed to load');
                }
                
                // Calculate percentage comparisons
                const volumePercentages = calculatePercentageComparisons(volumeData);
                const oiPercentages = calculatePercentageComparisons(openInterestData);

                // Display today's values at the top of each chart
                displayTodayStats(volumeData, 'volume-today', 'Kh·ªëi l∆∞·ª£ng giao d·ªãch');
                displayTodayStats(openInterestData, 'oi-today', 'Open Interest');

                // Render percentage comparison charts
                renderPercentageChart(volumePercentages, 'volumeComparisonChart', 'Hyperliquid vs CEXs');
                renderPercentageChart(oiPercentages, 'openInterestComparisonChart', 'Hyperliquid vs CEXs');

            } catch (error) {
                console.error('Error fetching comparison data:', error);
            }
        }

        function calculatePercentageComparisons(data) {
            try {
                if (!data || typeof data !== 'object' || Object.keys(data).length === 0) {
                    console.error('Invalid data format for percentage comparisons');
                    return {};
                }
                
                const result = {};
                const dates = Object.keys(data).sort(); // Sort dates chronologically
                
                if (dates.length === 0) {
                    console.error('No dates found in data');
                    return {};
                }
                
                // Create entries for each date
                dates.forEach(date => {
                    result[date] = {};
                    
                    if (!data[date] || typeof data[date] !== 'object') {
                        console.warn(`Invalid data for date ${date}`);
                        return;
                    }
                    
                    const hyperliquidValue = data[date]['HYPERLIQUID'] || 0;
                    
                    // Calculate percentage for each exchange
                    for (const exchange of ['BINANCE', 'BYBIT', 'OKX']) {
                        const exchangeValue = data[date][exchange] || 0;
                        if (exchangeValue > 0) {
                            // Calculate Hyperliquid as percentage of this exchange
                            result[date][exchange] = (hyperliquidValue / exchangeValue) * 100;
                        } else {
                            result[date][exchange] = 0;
                        }
                    }
                });
                
                return result;
            } catch (error) {
                console.error('Error in calculatePercentageComparisons:', error);
                return {};
            }
        }

        function displayTodayStats(data, containerId, title) {
            try {
                if (!data || Object.keys(data).length === 0) {
                    console.error(`No data available for ${title}`);
                    return;
                }
                
                // Get the most recent date
                const dates = Object.keys(data).sort();
                const latestDate = dates[dates.length - 1];
                if (!latestDate) {
                    console.error(`No dates found in data for ${title}`);
                    return;
                }
                
                const latestData = data[latestDate];
                if (!latestData) {
                    console.error(`No data found for date ${latestDate} in ${title}`);
                    return;
                }
                
                // Format the date for display
                const displayDate = formatDate(latestDate);
                
                // Create or get container
                let container = document.getElementById(containerId);
                if (!container) {
                    container = document.createElement('div');
                    container.id = containerId;
                    container.className = 'today-stats';
                    
                    // Find where to insert it
                    const chartId = title.includes('Open Interest') ? 
                        'openInterestComparisonChart' : 'volumeComparisonChart';
                    const chartContainer = document.getElementById(chartId);
                    if (!chartContainer) {
                        console.error(`Chart container ${chartId} not found`);
                        return;
                    }
                    const parentNode = chartContainer.parentNode;
                    if (!parentNode) {
                        console.error(`Parent node of ${chartId} not found`);
                        return;
                    }
                    parentNode.parentNode.insertBefore(container, parentNode);
                }
                
                // Hyperliquid value
                const hyperliquidValue = latestData['HYPERLIQUID'] || 0;
                const formattedValue = formatLargeNumber(hyperliquidValue);
                
                // Create HTML content
                let html = `<div class="today-value">${title}: <span>${formattedValue}</span></div>`;
                html += '<div class="today-comparisons">';
                
                // Add comparison percentages with colored dots
                const exchanges = [
                    { name: 'BINANCE', color: '#3366FF' },
                    { name: 'BYBIT', color: '#FF33A8' },
                    { name: 'OKX', color: '#33FF57' }
                ];
                
                exchanges.forEach(exchange => {
                    if (latestData[exchange.name]) {
                        const percentage = ((hyperliquidValue / latestData[exchange.name]) * 100).toFixed(1);
                        html += `<div class="today-comparison-item">`;
                        html += `<span class="color-dot" style="background-color: ${exchange.color}"></span>`;
                        html += `<span class="exchange-name">${exchange.name}:</span>`;
                        html += `<span class="percentage-value">${percentage}%</span>`;
                        html += `</div>`;
                    }
                });
                
                html += '</div>';
                container.innerHTML = html;
            } catch (error) {
                console.error(`Error in displayTodayStats for ${title}:`, error);
            }
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        function formatLargeNumber(num) {
            if (num >= 1e9) {
                return '$' + (num / 1e9).toFixed(2) + 'B';
            } else if (num >= 1e6) {
                return '$' + (num / 1e6).toFixed(2) + 'M';
            } else if (num >= 1e3) {
                return '$' + (num / 1e3).toFixed(2) + 'K';
            } else {
                return '$' + num.toFixed(2);
            }
        }

        function renderPercentageChart(percentageData, chartId, labelPrefix) {
            try {
                // Remove loading state
                const chartElement = document.getElementById(chartId);
                if (!chartElement) {
                    console.error(`Chart element with ID ${chartId} not found`);
                    return;
                }
                
                if (chartElement.parentNode) {
                    chartElement.parentNode.classList.remove('loading');
                }
                
                // Validate data
                if (!percentageData || typeof percentageData !== 'object' || Object.keys(percentageData).length === 0) {
                    console.error(`Invalid percentage data for ${chartId}`);
                    return;
                }
                
                const dates = Object.keys(percentageData).sort(); // Sort dates chronologically
                if (dates.length === 0) {
                    console.error(`No dates found in percentage data for ${chartId}`);
                    return;
                }
                
                const exchanges = ['BINANCE', 'BYBIT', 'OKX'];
                const colors = {
                    'BINANCE': '#3366FF',
                    'BYBIT': '#FF33A8',
                    'OKX': '#33FF57'
                };
                
                const datasets = [];
                
                // Create datasets for each exchange comparison
                exchanges.forEach(exchange => {
                    try {
                        const values = dates.map(date => {
                            if (!percentageData[date]) return 0;
                            return percentageData[date][exchange] || 0;
                        });
                        
                        // Get the latest value for the legend label
                        const latestValue = values.length > 0 ? values[values.length - 1].toFixed(1) : '0.0';
                        
                        datasets.push({
                            label: `${exchange}: ${latestValue}%`,
                            data: values,
                            borderColor: colors[exchange],
                            backgroundColor: 'transparent',
                            fill: false,
                            tension: 0.4,
                            borderWidth: 2,
                            pointRadius: 0,
                            pointHoverRadius: 5
                        });
                    } catch (exchangeError) {
                        console.error(`Error processing data for exchange ${exchange}:`, exchangeError);
                    }
                });
                
                if (datasets.length === 0) {
                    console.error(`No valid datasets created for ${chartId}`);
                    return;
                }

                // Add a watermark to the chart
                const watermarkPlugin = {
                    id: 'watermark',
                    beforeDraw: function(chart) {
                        const ctx = chart.ctx;
                        const width = chart.width;
                        const height = chart.height;
                        
                        ctx.save();
                        ctx.globalAlpha = 0.1;
                        ctx.font = '30px Arial';
                        ctx.fillStyle = '#33FF57';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText('HYPEFLOWS', width / 2, height / 2);
                        ctx.restore();
                    }
                };
                
                new Chart(document.getElementById(chartId).getContext('2d'), {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 10,
                                font: {
                                    weight: 'bold'
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw.toFixed(1);
                                    return `vs ${context.dataset.label.split(':')[0]}: ${value}%`;
                                },
                                title: function(tooltipItems) {
                                    return formatDate(tooltipItems[0].label);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                maxTicksLimit: 8,
                                maxRotation: 0
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '%'
                            },
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                },
                plugins: [watermarkPlugin]
            });
            } catch (error) {
                console.error(`Error rendering percentage chart ${chartId}:`, error);
            }
        }

        // Add some CSS for the stats display
        const style = document.createElement('style');
        style.textContent = `
            .stats-comparisons {
                display: flex;
                flex-wrap: wrap;
                gap: 15px;
                margin-top: 10px;
            }
            .stats-comparison-item {
                background: rgba(0,0,0,0.05);
                padding: 5px 10px;
                border-radius: 4px;
            }
            .comparison-label {
                font-size: 0.9em;
                margin-right: 5px;
            }
            .comparison-value {
                font-weight: bold;
            }
        `;
        document.head.appendChild(style);

        // Call the functions to fetch and render all charts when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            initAllData();
            fetchAndRenderComparisonCharts();
        });
    </script>
    <script src="js/animations.js"></script>
</body>
</html>
